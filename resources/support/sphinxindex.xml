<?xml version="1.0" encoding="utf-8"?>
<sphinx:docset>
<sphinx:document id="14614629">
<doc_id>
<![CDATA[14614629]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Обновление 1.3.0 -> 1.4.x]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Обновление 1.3.0 -&gt; 1.4.x</h2><p class="auto-cursor-target"><br/></p><div class="alert alert-warning"><div class="rich-text"><p>Перед началом обновления необходимо выяснить версию лицензии вашего сервера. Если она 2016R1 её необходимо обновить до 2017 Сервер Сибрус версии 1.4.3 и новее работает только с лицензиями 2017</p></div></div><p>Запустите в консоли сервера программу <strong>cybrusadm</strong> указав в параметрах <strong>domain</strong> и <strong>dbname</strong> соответственно ваше имя базы данных и наименование домена Сибрус</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\bin\cybrusadm --dbname cybrus_server --domain cybrus.sample  --operation print_server_license</div></div></div><p>В выводе программы найдите строку <strong>Valid for releases:</strong> или  <strong>Действительно для релизов:</strong> в ней будет указана версия лицензии. Если указана версия, отличная он 2017 Вам необходимо запросить у своего менеджера новую лицензию.</p><p>После получения файла новой лицензии, её необходимо активировать.</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\bin\cybrusadm --dbname cybrus_server --domain cybrus.sample -o activate_license --license-file cybrus_license_ххххххх.dat</div></div></div><p>После этого Вы можете приступить к обновлению сервера</p><h4>1. Остановите сервисы Сибрус</h4><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">net stop CybrusConfig</div><div class="line">net stop CybrusRelay</div><div class="line">net stop CybrusServer</div></div></div><h4>2. Обязательно сделайте резервную копию базы данных</h4><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\mongo\mongodump --host 127.0.0.1 --port 27017 --db cybrus_server --out c:\cybrus\mongo\backup01\</div></div></div><p>бекап запишется в текущую папку в c:\cybrus\mongo\backup01\</p><h4>3. Обновите сервер Сибрус</h4><p>перезаписав содержимое папок c:\cybrus\server\bin\ и c:\cybrus\server\locale соответствующим содержимым архива с новым дистрибутивом</p><h4>4. Обновите структуру базы данных</h4><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrus-server.exe --upgrade-to-collection-map -c c:\cybrus\server\config\server.config </div></div></div><h4>5. Обновите базу и индексы базы данных</h4><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrus-database-adm.exe --dbname cybrus_server --domain cybrus.sample --mongo-uri 127.0.0.1:27017 -o database-upgrade</div><div class="line">c:\cybrus\server\bin\cybrus-database-adm.exe --dbname cybrus_server --domain cybrus.sample --mongo-uri 127.0.0.1:27017 --drop-indexes -o indexes-create </div></div></div><h4>6. Запустите сервисы Сибрус</h4><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">net start CybrusServer</div><div class="line">net start CybrusRelay</div><div class="line">net start CybrusConfig</div></div></div><h4>Если при выполнении п.5 происходит ошибка при удалении индексов:</h4><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\&gt;c:\cybrus\server\bin\cybrus-database-adm --dbname cybrus_server --domain cybrus.sample --mongo-uri 127.0.0.1:27017 --drop-indexes -o indexes-create </div><div class="line">исключение mogno: 10007 dropIndex failed </div><div class="line">terminate called after throwing an instance of 'mongo::DBException' </div><div class="line">what(): dropIndex failed </div><div class="line">Аварийный останов </div><div class="line">c:\&gt;</div></div></div><p>нужно подключиться консолью монги к базе данных и выполнить удаление индексов вручную </p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\&gt;c:\cybrus\mongo\bin\mongo cybrus_server </div><div class="line">&gt; db.getCollectionNames().forEach(function (d) { db[d].dropIndexes(); }); </div><div class="line">&gt; quit </div><div class="line">c:\&gt;</div></div></div><p class="auto-cursor-target"><br/></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="14614631">
<doc_id>
<![CDATA[14614631]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Обновление 1.4.x -> 1.4.y]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Обновление 1.4.x -&gt; 1.4.y</h2><h3 class="auto-cursor-target">Windows server</h3><p>1. Остановите сервисы Сибрус</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">net stop CybrusConfig</div><div class="line">net stop CybrusRelay</div><div class="line">net stop CybrusServer</div></div></div><p>2. Обязательно сделайте резервную копию базы данных</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\mongo\mongodump --host 127.0.0.1 --port 27017 --db cybrus_server --out c:\cybrus\mongo\backup01\</div></div></div><p>бекап запишется в текущую папку в c:\cybrus\mongo\backup01\</p><p>3. Обновите сервер Сибрус, перезаписав содержимое папок c:\cybrus\server\bin\ и c:\cybrus\server\locale соответствующим содержимым архива с новым дистрибутивом</p><p>4. Обновите базу и индексы базы данных</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrus-database-adm.exe --dbname cybrus_server --domain cybrus.sample --mongo-uri 127.0.0.1:27017 -o database-upgrade</div><div class="line">c:\cybrus\server\bin\cybrus-database-adm.exe --dbname cybrus_server --domain cybrus.sample --mongo-uri 127.0.0.1:27017 --drop-indexes -o indexes-create </div></div></div><p>5. Запустите сервисы Сибрус</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">net start CybrusServer</div><div class="line">net start CybrusRelay</div><div class="line">net start CybrusConfig</div></div></div><h4>Если при выполнении п.4 происходит ошибка при удалении индексов:</h4><div class="alert alert-noformat"><div class="codeContent panelContent pdl"><div class="line">c:\&gt;c:\cybrus\server\bin\cybrus-database-adm --dbname cybrus_server --domain cybrus.sample --mongo-uri 127.0.0.1:27017 --drop-indexes -o indexes-create</div><div class="line">исключение mogno: 10007 dropIndex failed</div><div class="line">terminate called after throwing an instance of 'mongo::DBException'</div><div class="line">what(): dropIndex failed</div><div class="line">Аварийный останов</div><div class="line">c:\&gt;</div></div></div><p>нужно подключиться консолью монги к базе данных и выполнить удаление индексов вручную </p><div class="alert alert-noformat"><div class="codeContent panelContent pdl"><div class="line">c:\&gt;c:\cybrus\mongo\bin\mongo cybrus_server</div><div class="line">&gt; db.getCollectionNames().forEach(function (d) { db[d].dropIndexes(); });</div><div class="line">&gt; quit</div><div class="line">c:\&gt;</div></div></div><p class="auto-cursor-target"><br/></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="8716723">
<doc_id>
<![CDATA[8716723]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Настройка сервера автоконфигурации]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Настройка сервера автоконфигурации</h2><p>Сервер автоконфигурации используется для автоматической настройки клиента на работу именно с вашим сервером Сибрус. Все передаваемые клиенту параметры описаны в файле client_autoconf.config </p><div class="alert alert-note"><div class="rich-text">Использование Сервера Автоконфигурации не является обязательным и его настройку и запуск можно пропустить.</div></div><p>При первом запуске вы должны сообщить клиентскому приложению адрес вашего сервера Сибрус:</p><ol><li><span>Указав явно в настройках клиентского приложения. "Параметры" "Хост" . При этом сервер автоконфигурации не требуется.</span></li><li><span>Загрузив конфигурацию клиента, содержащую в том числе адрес сервера Сибрус, используя сервер автоконфигурации <br/>А. Вручную, выбрав "Параметры" "Хост" "Загрузить параметры с сервера" при первоначальном запуске клиента и явно указав IP-адрес и порт сервера автоконфигурации.<br/>Б. Воспользоваться сервисом domains.cybrus.ru  Для этого Вы должны сообщить нам внешний IP-адрес или DNS-имя своего сервера и название домена Сибрус. Тогда клиентское приложение сможет при первом запуске по логину вида имя_пользователя@имя_домена через наш сервис найти IP-адрес вашего сервера Сибрус<br/>В. Если домен Сибрус совпадает с доменом службы DNS , вы можете создать SRV запись на сервере DNS по которой клиентское приложение будет находить IP-адрес сервера Сибрус. <br/>Для домена cybrus.example и сервера srv.cybrus.example SRV запись будет выглядеть следующим образом<br/>_cybrusc._tcp.cybrus.example    SRV   0 0 37212 srv.cybrus.example.<br/>Г. Загрузив при первоначальном запуске клиента параметры из файла .dfs (этот файл формируется администратором и позволяет конфигурировать клиента не используя сервис автоконфигурации)</span></li></ol><h3>Настройка Сервера Автоконфигурации.</h3><h4>1. Получите ключ и сертификат</h4><p>Параметры, передаваемые клиенту с сервера автоконфигурации, шифруются. Вы должны использовать сертификат, подписанный разработчиками Сибрус или вашем доверенным центром сертификации как описано в разделе "Генерация ключей и получение сертификата сервера Сибрус". Для сервера автоконфигурации не допускается использовать самоподписанный сертификат.</p><h4>2. Настройте Сервер Автоконфигурации</h4><p>Скопируйте содержимое файла c:\cybrus\server\config\server.config.sample в c:\cybrus\server\config\server-auto.config .</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">copy c:\cybrus\server\config\server-auto.config.sample c:\cybrus\server\config\server-auto.config</div></div></div><p>Отредактируйте файл server-auto.config, указав следующие параметры</p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th colspan="2">Обязательные параметры</th></tr><tr><td><pre class="config">private-key-file = c:\cybrus\server\config\cybrus.key</pre></td><td><span>Путь к приватному ключу сервера</span><span>, полученному в разделе "Генерация ключей и получение сертификата сервера"</span></td></tr><tr><td><pre class="config">private-key-file-passphrase = secret_passphrase</pre></td><td><span>Парольная фраза приватного ключа</span><span>, полученная в разделе "Генерация ключей и получение сертификата сервера"</span></td></tr><tr><td><pre class="config">certificate-chain-file = <br/>c:\cybrus\server\config\cybrus_certificate.pem</pre></td><td><span>Путь к сертификату сервера</span><span>, полученному в разделе "Генерация ключей и получение сертификата сервера"</span></td></tr><tr><td><pre>domain = cybrus.example</pre></td><td><span>Домен вашего сервера Сибрус</span><span>, который вы указывали при инициализации базы данных</span></td></tr><tr><td><pre class="config">listen-address = 0.0.0.0</pre></td><td>IP-адрес Сервера Автоконфигурации. Здесь необходимо указать IP адрес, на котором Сервер Автоконфигурации будет принимать подключения. Адрес 0.0.0.0 означает  все интерфейсы . Можно так же указать конкретный IP-адрес внешнего интерфейса сервера Windows.</td></tr><tr><td><pre class="config">listen-port = 37212</pre></td><td>Номер порта Сервера Автоконфигурации</td></tr><tr><td><pre class="config">mongo-address = 127.0.0.1</pre></td><td>IP адрес MongoDB сервера</td></tr><tr><td><pre class="config">mongo-port = 27017</pre></td><td>TCP порт MongoDB сервера</td></tr><tr><td colspan="1"><pre class="config">dbname = cybrus_server</pre></td><td colspan="1">Имя базы данных</td></tr></tbody></table></div><h4>3. Отредактируйте файл автоконфигурации клиента</h4><p>В этом файле описываются параметры, которые передаются клиенту сервером автоконфигурации.</p><p>Скопируйте содержимое файла</p><p>c:\cybrus\server\config\client_autoconf.config.sample в c:\cybrus\server\config\client_autoconf.config</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">copy c:\cybrus\server\config\client_autoconf.config.sample c:\cybrus\server\config\client_autoconf.config</div></div></div><p>Отредактируйте файл client_autoconf.config, указав следующие параметры:</p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th><br/></th><th><br/></th></tr><tr><td>autoconf-use-access-code=0</td><td>Необходимость ввода код доступа при автоконфигурации</td></tr><tr><td>autoconf-access-code=</td><td>код доступа, если он используется</td></tr><tr><td>cybrus-server-certificate-file= c:\cybrus\server\config\cybrus_certificate.pem</td><td>файл сертификата cервера Сибрус</td></tr><tr><td>cybrus-server-host=10.10.1.180</td><td>Укажите доменное имя или IP-адрес вашего Сервера (IP адрес должен совпадать со значением параметра external-listen-address, установленным в п.7)</td></tr><tr><td>cybrus-server-port=37210</td><td>Номер порта Сервера</td></tr><tr><td>sip-enable=0</td><td>Использование SIP сервера</td></tr><tr><td>sip-strict-phone-number=1</td><td>Если используются номера в стандарте E.123 (Номер должен начинаться с + , затем код страны и номер телефона, например, +123456789), установите параметр  1. Если допускаются любые номера, например, SIP  сервер это ваша местная станция, установите параметр в 0. При этом допускаются любые номера. Например, 106).</td></tr></tbody></table></div><p><br/></p><h4>4. Сохраните настройки автоконфигурации в базе данных</h4><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrusadm --operation save_clients_autoconf --clients-autoconf-file c:\cybrus\server\config\client_autoconf.config --domain cybrus.example --dbname cybrus_server</div></div></div><p>На запрос  Enter passphrase to decrypt private key  введите пароль из п.1</p><p>Если вам потребуется сменить настройки автоконфигурации, отредактируйте  файл client_autoconf.config и опять выполните cybrusadm  с операцией save_clients_autoconf. После сохранения параметров автоконфигурации необходимо перезапустить только Сервер Автоконфигурации.</p><h4>5. Запустите Сервер Автоконфигурации как консольное приложение:</h4><p>Сначала выполните команду, чтобы убедиться, что в файле конфигурации нет ошибок:</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrus-server --autoconf --config c:\cybrus\server\config\server-auto.config</div></div></div><p>Если не появилось приглашение командной строки, значит, сервер успешно стартовал. Прервите его работу, нажав CTRL+C.</p><p>Затем запустите его в отдельном окне командой:</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">start c:\cybrus\server\bin\cybrus-server --autoconf --config c:\cybrus\server\config\server-auto.config</div></div></div><p class="auto-cursor-target">После окончания настройки всех сервисов Сибрус, рекомендуется настроить их запуск как сервисов Windows. См. раздел "Настройка запуска сервера Сибрус как сервиса Windows"</p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="13008932">
<doc_id>
<![CDATA[13008932]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Настройка запуска сервера Сибрус как сервиса Windows]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Настройка запуска сервера Сибрус как сервиса Windows</h2><p>Исполняемые файлы сервера Сибрус являются win32 консольными приложениями. Для запуска их как сервисы Windows используется программа <a href="http://nssm.cc/">nssm</a></p><p>Для проверки файлов конфигурации вы можете просто запускать приложения с консоли или в отдельном окне консоли командой start</p><p>Запуск как сервис рекомендуется из-за возможности устанавливать очередность и зависимость запуска сервисов и автоматического старта сервисов при загрузке Windows</p><p>Для автоматической настройки запуска сервера Сибрус как сервисов Windows вы  можете использовать командный файл install-services.cmd, для удаления сервисов предназначен командный файл remove-services.cmd . запуск и остановку сервисов можно выполнять с помощью командных файлов start-services.cmd  и stop-services.cmd соответственно или с помощью стандартной команды WIndows net start | stop или с помощью стандартной оснастки Windows <span>services.msc</span></p><div class="code panel pdl"><div class="codeHeader panelHeader pdl">install-services.cmd</div><div class="codeContent panelContent pdl"><div class="line">nssm install CybrusConfig c:\cybrus\server\bin\cybrus-server.exe "--autoconf --config c:\cybrus\server\config\server-auto.config --logfile c:\cybrus\autoconf.log --logfile-fatal c:\cybrus\autoconf-fatal.log" </div><div class="line">nssm install CybrusServer c:\cybrus\server\bin\cybrus-server.exe "--config c:\cybrus\server\config\server.config --logfile c:\cybrus\server.log --logfile-fatal c:\cybrus\server-fatal.log" </div><div class="line">nssm install CybrusRelay c:\cybrus\server\bin\cybrus-relay.exe "--config c:\cybrus\server\config\relay.config --logfile c:\cybrus\relay.log" </div><div class="line">nssm set CybrusRelay DependOnService CybrusServer </div><div class="line">nssm set CybrusRelay AppStdout "c:\cybrus\Relay-stdout.log"</div><div class="line">nssm set CybrusRelay AppStderr "c:\cybrus\Relay-stderr.log"</div><div class="line">nssm set CybrusRelay Description "Cybrus Relay Server" </div><div class="line">nssm set CybrusServer DependOnService MongoDB redis </div><div class="line">nssm set CybrusServer AppStdout "c:\cybrus\Server-stdout.log"</div><div class="line">nssm set CybrusServer AppStderr "c:\cybrus\Server-stderr.log"</div><div class="line">nssm set CybrusServer Description "Cybrus Server" </div><div class="line">nssm set CybrusConfig DependOnService MongoDB redis </div><div class="line">nssm set CybrusConfig AppStdout "c:\cybrus\Config-stdout.log"</div><div class="line">nssm set CybrusConfig AppStderr "c:\cybrus\Config-stderr.log"</div><div class="line">nssm set CybrusConfig Description "Cybrus Autoconfig Server" </div></div></div><p class="auto-cursor-target"><br/></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="13008938">
<doc_id>
<![CDATA[13008938]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Конфигурирование сервера Сибрус]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Конфигурирование сервера Сибрус</h2><p>Скопируйте содержимое файла c:\cybrus\server\config\server.config.sample в c:\cybrus\server\config\server.config</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">copy c:\cybrus\server\config\server.config.sample c:\cybrus\server\config\server.config</div></div></div><p>Отредактируйте c:\cybrus\server\config\server.config :</p><p>Отредактируйте файл server-auto.config, указав следующие параметры</p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th colspan="2">Обязательные параметры</th></tr><tr><td><pre class="config">private-key-file = c:\cybrus\server\config\cybrus.key</pre></td><td><span>Путь к приватному ключу сервера</span><span>, полученному в разделе "Генерация ключей и получение сертификата сервера"</span></td></tr><tr><td><pre class="config">private-key-file-passphrase = secret_passphrase</pre></td><td><span>Парольная фраза приватного ключа</span><span>, полученная в разделе "Генерация ключей и получение сертификата сервера"</span></td></tr><tr><td><pre class="config">certificate-chain-file = c:\cybrus\server\config\cybrus_certificate.pem</pre></td><td><span>Путь к сертификату сервера</span><span>, полученному в разделе "Генерация ключей и получение сертификата сервера"</span></td></tr><tr><td><pre>domain = cybrus.example</pre></td><td>Домен вашего сервера Сибрус<span>, который вы указывали при инициализации базы данных</span></td></tr><tr><td><pre class="config">listen-address = 0.0.0.0</pre></td><td>IP-адрес сервера Сибрус. Здесь необходимо указать IP адрес, на котором <span>сервер Сибрус </span>будет принимать подключения. Адрес 0.0.0.0 означает  все интерфейсы . Можно так же указать конкретный IP-адрес внешнего интерфейса сервера Windows.</td></tr><tr><td><pre class="config">listen-port = 37210</pre></td><td>Номер порта <span>сервера Сибрус</span></td></tr><tr><td><pre class="config">mongo-address = 127.0.0.1</pre></td><td>IP адрес MongoDB сервера</td></tr><tr><td><pre class="config">mongo-port = 27017</pre></td><td>TCP порт MongoDB сервера</td></tr><tr><td colspan="1"><pre class="config">dbname = cybrus_server</pre></td><td colspan="1">Имя базы данных</td></tr></tbody></table></div><p class="auto-cursor-target"><br/></p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th colspan="2">необязательные параметры</th></tr><tr><td>ldap-enabled = 0</td><td>Поддержка LDAP аутентификации</td></tr><tr><td>sip-enable=false</td><td>Поддержка SIP</td></tr><tr><td>sip-enable-admin=true</td><td>Настройка SIP-аккаунта пользователя из панели администрирования</td></tr><tr><td>sip-server-address = 192.168.1.65</td><td>Адрес SIP сервера</td></tr><tr><td>sip-server-port=5060</td><td>Номер UDP порта SIP сервера</td></tr><tr><td>sip-local-address = 192.168.1.215</td><td>Реальный адрес сервера СИБРУС, который будет использоваться для связи с SIP сервером.</td></tr><tr><td>sip-phone-domain = sip-to-phone.cybrus.example</td><td>Доменное имя SIP phone. Этот домен будет добавляться к номеру. (например, +12345678@<a href="http://sip-to-phone.example.com">sip-to-phone.example.com</a> - <a href="http://sip-to-phone.example.com">sip-to-phone.example.com</a> это домен).<p class="config">Этот параметр может быть IP-адресам SIP-сервера, если такое допускают настройки вашего SIP-сервера. Например, sip-phone-domain = 192.168.1.65</p></td></tr></tbody></table></div><p><br/></p><h4>5. Запустите Сервер Автоконфигурации как консольное приложение:</h4><p>Сначала выполните команду, чтобы убедиться, что в файле конфигурации нет ошибок:</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrus-server --config c:\cybrus\server\config\server.config</div></div></div><p>Если в течение 30 секунд не появилось приглашение командной строки, значит, сервер успешно стартовал. Прервите его работу, нажав CTRL+C.</p><p>Затем запустите его в отдельном окне командой:</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">start c:\cybrus\server\bin\cybrus-server --config c:\cybrus\server\config\server.config</div></div></div><p class="config">После окончания настройки всех сервисов Сибрус, рекомендуется настроить их запуск как сервисов Windows. См. раздел "Настройка запуска сервера Сибрус как сервиса Windows"</p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="13008940">
<doc_id>
<![CDATA[13008940]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Конфигурирование Медиаретранслятора]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Конфигурирование Медиаретранслятора</h2><p class="header1">Медиаретранслятор используется для организации голосовых и видео звонков и конференций. При звонке передача данных между клиентскими приложениями сначала запускается "точка-точка" , а в случае неудачи - через Медиаретранслятор. Если при приёме звонка вы включили флаг "Скрывать мой IP" звонок сразу организуется через Медиаретранслятор. Конференции всегда организуются через Медиаретранслятор.</p><p class="header1">Скопируйте содержимое файла c:\cybrus\server\config\relay.config.sample в c:\cybrus\server\config\relay.config</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">copy c:\cybrus\server\config\relay.config.sample c:\cybrus\server\config\relay.config</div></div></div><p>Отредактируйте c:\cybrus\server\config\relay.config</p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th colspan="2">Обязательные параметры</th></tr><tr><td><pre class="config">external-listen-hostname=</pre></td><td><p>Внешний IP-адрес, то есть тот, который сообщается клиентам для подключения . Обычно это адрес внешнего сетевого интерфейса сервера Windows. В случае, если Вы установили сервер за NAT ом и используете проброс портов (port forwarding), в качестве external-listen-hostname следует указывать внешний адрес NAT а. Адрес можно указывать в виде IP-адреса или DNS имени</p></td></tr><tr><td>login=</td><td>Логин Медиаретранслятора, установленный опцией --relayserver-login при инициализации базы данных. Если вы используете несколько Медиаретрансляторов, они должны использовать общий логин.</td></tr><tr><td colspan="1">passwd=&lt;пароль&gt;</td><td colspan="1">Пароль Медиаретранслятора, установленный при инициализации базы данных</td></tr><tr><td>domain=</td><td>доменное имя, которое вы указывали при инициализации базы данных</td></tr><tr><td>certificate=c:\cybrus\server\config\cybrus_certificate.pem</td><td>Путь к сертификату, полученному в разделе "Генерация ключей и получение сертификата сервера"</td></tr><tr><td>server-host=</td><td>Адрес сервера Сибрус</td></tr><tr><td>server-port=</td><td>Порт сервера Сибрус</td></tr></tbody></table></div><h4>Запустите Сервер Автоконфигурации как консольное приложение:</h4><p>Сначала выполните команду, чтобы убедиться, что в файле конфигурации нет ошибок:</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrus-relay --config c:\cybrus\server\config\relay.config</div></div></div><p>Если не появилось приглашение командной строки, значит, Медиаретранслятор успешно стартовал. Прервите его работу, нажав CTRL+C.</p><p>Затем запустите его в отдельном окне командой:</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">start c:\cybrus\server\bin\cybrus-relay --config c:\cybrus\server\config\relay.config</div></div></div><p>После окончания настройки всех сервисов Сибрус, рекомендуется настроить их запуск как сервисов Windows. См. раздел "Настройка запуска сервера Сибрус как сервиса Windows"</p><h4>Пример:</h4><p class="config">Медиаретранслятор запущен на хосте с внутренним IP-адресом 192.168.10.15</p><p class="config">Из Интернета порты на него проброшены с роутера с IP-адресом внешнего интерфейса 10.10.10.15</p><ul class="square"><li><span>если все клиенты находятся в интрасети, нужно указать в параметре адрес внутреннего интерфейса<br/>external-listen-hostname=192.168.10.15<br/>и все клиенты смогут использовать Медиаретранслятор для звонков, подключаясь к нему по интранетовскому адресу</span></li><li><span>если все клиенты находятся в Интернете, можно указать в параметре адрес внешнего интерфейса роутера или DNS-имя<br/>external-listen-hostname=10.10.10.15<br/>и все клиенты смогут использовать Медиаретранслятор для звонков, подключаясь к нему по интернетовскому адресу</span></li><li><span>если клиенты находятся в интранете и в Интернете, можно указать параметр <br/>external-listen-hostname=10.10.10.15<br/>и все клиенты смогут использовать Медиаретранслятор для звонков, подключаясь к нему по интернетовскому адресу при условии, что роутер позволяет обращаться к своему внешнему интерфейсу из интрасети</span></li><li><span>если клиенты находятся в интранете и в Интернете, рекомендуется  указать параметр в виде DNS имени. <br/>external-listen-hostname=relay.cybrus.example<br/>Если для интрасети DNS имя будет указывать на интранет адрес Медиаретранслятора, а для Интернета на IP-адрес внешнего интерфейса роутера, у клиентов в интрасети не будет проблемы с маршрутизацией.</span></li></ul></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="8716657">
<doc_id>
<![CDATA[8716657]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Подготовка Windows Server]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Подготовка Windows Server</h2><p>Командная строка должна быть запущена с правами администратора сервера Windows. Запустить консоль администратора можно так</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2017-11-15_13-24-16.png"/></span></p><div class="alert alert-warning"><div class="rich-text"><p>Перед началом установки необходимо установить все рекомендуемые обновления Windows server.</p></div></div><p>В системе так же должен быть установлен "Распространяемый пакет Visual C++ для Visual Studio 2015" ("Visual C++ Redistributable for Visual Studio 2015") . Скачать его можно по ссылке <span class="nolink"><a href="https://www.microsoft.com/ru-RU/download/details.aspx?id=48145">https://www.microsoft.com/ru-RU/download/details.aspx?id=48145</a> </span></p><p>Иначе при запуске программ пакета Сибрус будет возникать ошибка</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2017-11-15_13-26-51.png"/></span></p><p>Для нормальной работы сервера необходимо настроить брандмауэр Windows. Необходимо разрешить входящие соединения на TCP порты 37210 и 37212 , а так же на диапазон UDP портов 3000-9000.</p><div class="alert alert-warning"><div class="rich-text">Обратите внимание, что доступ из Интернета к портам 6379 (Redis) и 27017 (MongoDB) должен быть закрыт.</div></div><p class="auto-cursor-target"><br/></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="13008944">
<doc_id>
<![CDATA[13008944]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Конфигурирование пуш-сервиса]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Конфигурирование пуш-сервиса</h2><p>На мобильных платформах iOS и Android 8 , операционная система для экономии заряда батареи и памяти может останавливать приложения, полностью отключая их от сети. Чтоб приложение могло реагировать на звонки и сообщения, используется т.н. пуш-технология. Сервер Сибрус, отправляя сообщение клиентскому приложению, запущенному на мобильной платформе, через свой сервис pushd передает специальное пуш-сообщение соответственно через серверы Apple или Google мобильному клиенту. Сообщение не содержит никакой секретной информации и используется только для активации мобильного приложения. Запустившись, мобильное приложение обычным образом принимает сообщение или входящий звонок.</p><p>Для использования push-нотификаций необходимо:</p><ol><li><span>Получить у поставщика сервера СИБРУС сертификат шлюза, а так же сертификат и ключ клиента.</span></li><li><span>Включить поддержку push-нотификаций на сервере СИБРУС. </span></li><li><span>Сконфигурировать и запустить сервис пушей</span></li></ol><h3>Включение поддержки push-нотификаций на сервере СИБРУС. </h3><p>Для этого в файле конфигурации сервера СИБРУС /etc/cybrus/server.config необходимо указать опцию</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">push-notifications-enabled = true</div></div></div><h3>Конфигурирование сервиса пушей</h3><p>Распакуйте в папку c:\cybrus\server\config\ полученный в архиве файлы ca.crt, clientXX.key и clientXX.crt. Они одинаковые и для iOS и Android шлюза. Отредактируйте файл c:\cybrus\server\config\pushd.config , указав правильные имена файлов сертификатов и ключей в параметрах</p><pre>Для шлюза iOS:</pre><pre>apple-ca = 
apple-client-cert =<br/>apple-client-key = </pre><p>для шлюза Android:</p><pre>fcm-ca = <br/>fcm-client-cert = <br/>fcm-client-key = </pre><p>остальные параметры без необходимости изменять не надо</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="comment line">##############################################</div><div class="comment line"># Sample configuration file of cybrus pushd #</div><div class="comment line">##############################################</div><div class="comment line"># Name of database in MongoDB</div><div class="line">database = cybrus_server</div><div class="comment line"># IP address of MongoDB server</div><div class="line">mongo-address = 127.0.0.1</div><div class="comment line"># TCP port of MongoDB server</div><div class="line">mongo-port = 27017</div><div class="comment line"># IP address of Redis server</div><div class="line">redis-address = 127.0.0.1</div><div class="comment line"># TCP port of Redis server</div><div class="line">redis-port = 6379</div><div class="comment line"># Apple push notifications via cybrus-gateway-apple</div><div class="comment line">#</div><div class="comment line"># Enable Apple's push notifications</div><div class="line">apple-enabled = true</div><div class="line">fcm-enabled = true</div><div class="comment line"># HTTP or HTTPS?</div><div class="line">apple-https = true</div><div class="line">fcm-https = true</div><div class="comment line"># IP address of the gateway server</div><div class="line">apple-server-addr = push-gateway.cybrus.ru</div><div class="line">fcm-server-addr = push-gateway.cybrus.ru</div><div class="comment line"># TCP port of the gateway server</div><div class="line">apple-server-port = 2443</div><div class="line">fcm-server-port = 3443</div><div class="comment line"># Verify peer's SSL certificate</div><div class="line">apple-verify-peer = true</div><div class="line">fcm-verify-peer = true</div><div class="comment line"># The gateway's CA</div><div class="line">apple-ca = c:\cybrus\server\config\ca.crt</div><div class="line">fcm-ca = c:\cybrus\server\config\ca.crt</div><div class="comment line"># SSL certificate which is passed to the gateway</div><div class="line">apple-client-cert = c:\cybrus\server\config\client01.crt</div><div class="line">fcm-client-cert = c:\cybrus\server\config\client01.crt</div><div class="comment line"># The key for apple-client-cert</div><div class="line">apple-client-key = c:\cybrus\server\config\client01.key</div><div class="line">fcm-client-key = c:\cybrus\server\config\client01.key</div><div class="comment line"># The apple-client-key's passphrase</div><div class="line">apple-client-key-passphrase =</div><div class="line">fcm-client-key-passphrase =</div><div class="comment line"># How long to wait for the gateway's response</div><div class="line">apple-timeout-ms = 20000</div><div class="line">fcm-timeout-ms = 20000</div><div class="comment line"># Should we throttle notifications with the same token?</div><div class="line">apple-delay-enabled = true</div><div class="comment line">#fcm-delay-enabled = true</div><div class="line">apple-delay-ms = 1500</div><div class="comment line">#fcm-delay-ms = 1500</div><div class="comment line"># Enable logging for every notification</div><div class="comment line"># Do not enable for production</div><div class="line">log-enabled = true</div><div class="line">verbose_level = 9</div><div class="line">fatal_log_file=c:\cybrus\pushd-fatal.log</div><div class="line">log_file=c:\cybrus\pushd.log</div></div></div><p>Настройте запуск службы пушей как сервиса Windows</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\nssm install CybrusPushD c:\cybrus\server\bin\cybrus-pushd.exe "--config c:\cybrus\server\config\pushd.config"</div><div class="line">c:\cybrus\server\bin\nssm set CybrusPushD DependOnService MongoDB redis</div><div class="line"> </div><div class="line">c:\cybrus\server\bin\nssm set CybrusPushD AppStdout "c:\cybrus\pushd-stdout.log"</div><div class="line">c:\cybrus\server\bin\nssm set CybrusPushD AppStderr "c:\cybrus\pushd-stderr.log"</div><div class="line">c:\cybrus\server\bin\nssm set CybrusPushD Description "Cybrus PushD"</div></div></div><p>Запустите службу пушей как сервис Windows</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">net start CybrusPushD </div></div></div><p class="auto-cursor-target"><br/></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="8716666">
<doc_id>
<![CDATA[8716666]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Установка Redis]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Установка Redis</h2><p>Скачайте инсталлятор Redis по <a href="https://github.com/MicrosoftArchive/redis/releases/download/win-2.8.2402/Redis-x64-2.8.2402.msi">ссылке</a> <span class="nolink">https://github.com/MicrosoftArchive/redis/releases/download/win-2.8.2402/Redis-x64-2.8.2402.msi</span></p><p>Запустите установку</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-29-56.png"/></span></p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-30-23.png"/></span></p><p>Установите пакет Redis в папку c:\cybrus\redis :</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-31-9.png"/></span></p><p>Оставьте порт для подключения к редису по-умолчанию</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-31-45.png"/></span></p><p>Включите установку размера используемой памяти</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-32-2.png"/></span></p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-32-17.png"/></span></p><p><br/></p><p>Если политики администрирования требуют, подтвердите установку в окне контроля учетных записей</p><div class="alert alert-note"><div class="rich-text"><p>Если по каким то причинам инсталлятор Redis-x64-2.8.2402.msi не работает, скачайте и распакуйте содержимое архива <a rel="nofollow" href="https://github.com/MicrosoftArchive/redis/releases/download/win-2.8.2402/Redis-x64-2.8.2402.zip" class="external-link">https://github.com/MicrosoftArchive/redis/releases/download/win-2.8.2402/Redis-x64-2.8.2402.zip</a> в папку c:\cybrus\redis и выполните с консоли с правами администратора команду</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\redis\redis-server --service-install c:\cybrus\redis\redis.windows-service.conf</div></div></div><p class="auto-cursor-target"><br/></p></div></div><p>Отредактируйте файл конфигурации c:\cybrus\redis\redis.windows-service.conf </p><p>Укажите прослушивание только локального интерфейса</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="comment line"># bind 192.168.1.100 10.0.0.1</div><div class="comment line"># bind 127.0.0.1</div></div></div><p>измените на</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="comment line"># bind 192.168.1.100 10.0.0.1</div><div class="line">bind 127.0.0.1</div></div></div><p>отключите сохранение базы данных на диск</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="comment line"># save ""</div><div class="line">save 900 1</div><div class="line">save 300 10</div><div class="line">save 60 10000</div></div></div><p>измените на</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">save ""</div><div class="comment line"># save 900 1</div><div class="comment line"># save 300 10</div><div class="comment line"># save 60 10000</div></div></div><p>и перезапустите сервис Редиса</p><p>После окончания установки, откройте оснастку "Службы" и убедитесь, что служба Redis запущена</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2017-11-16_2-59-46.png"/></span></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="8716676">
<doc_id>
<![CDATA[8716676]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Установка MongoDB]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Установка MongoDB</h2><p>Скачайте инсталлятор MongoDB по <a href="https://fastdl.mongodb.org/win32/mongodb-win32-x86_64-2008plus-3.4.10-signed.msi">ссылке</a> <a href="https://fastdl.mongodb.org/win32/mongodb-win32-x86_64-2008plus-3.4.10-signed.msi">https://fastdl.mongodb.org/win32/mongodb-win32-x86_64-2008plus-3.4.10-signed.msi</a></p><p><br/></p><p>Установите пакет программ MongoDB</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2017-11-15_16-18-33.png"/></span></p><p>Выберите настраиваемую установку</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-37-37.png"/></span></p><p>Устанавите MongoDB в папку c:\cybrus\mongoDB</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-38-34.png"/></span></p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-39-20.png"/></span></p><p>Если политики администрирования требуют, подтвердите установку в окне контроля учетных записей</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-40-49.png"/></span></p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-41-18.png"/></span></p><p>После окончания установки сервис Mongo необходимо сконфигурировать </p><p>Создайте папки для базы данных и для логов</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">md c:\cybrus\mongodb\log</div><div class="line">md c:\cybrus\mongodb\db</div></div></div><pre>выполните в командной строке</pre><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\mongodb\bin\mongod --port 27017 --bind_ip 127.0.0.1 --dbpath c:\cybrus\mongodb\db --logpath c:\cybrus\mongodb\log\mongo.log --install</div></div></div><pre>Запустите сервис MongoDB</pre><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">net start mongodb</div></div></div><p>Открыв оснастку "Службы" убедитесь, что сервис MongoDB запущен</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2017-11-16_2-50-48.png"/></span></p><div class="alert alert-note"><div class="rich-text"><p>Если вы планируете в дальнейшем выполнить дополнительную настройку сервиса Mongo, рекомендуется создать файл конфигурации сервиса и все настройки выполнять в нём. Все изменения конфигурации буду применяться после перезапуска сервиса.</p><pre>Cоздайте в папке c:\cybrus\mongodb\bin\ файл конфигурации mongod.cfg</pre><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">net:</div><div class="line">   port: 27017</div><div class="line">   bindIp: 127.0.0.1</div><div class="line">systemLog: </div><div class="line">   destination: file </div><div class="line">   path: c:\cybrus\mongodb\log\mongod.log </div><div class="line">storage: </div><div class="line">   dbPath: c:\cybrus\mongodb\db</div></div></div><p>Установите MongoDB как сервис, выполнив в консоли команду </p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\mongodb\bin\mongod.exe --config "c:\cybrus\mongodb\bin\mongod.cfg" --install</div></div></div><p class="auto-cursor-target"><br/></p></div></div></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="14614626">
<doc_id>
<![CDATA[14614626]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Обновление сервера Сибрус]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Обновление сервера Сибрус</h2><p>Общий порядок обновления</p><ol><li><span>Остановить все сервисы Сибрус командой</span></li><li><span>Сделать бекап базы данных</span></li><li><span>Обновить исполняемые файлы сервера и базу переводов</span></li><li><span>Заполнить в консоли сервер сибрус</span></li><li><span>Если в логе есть сообщение о необходимости выполнить обновление индексов, то выполнить операцию обновления</span></li><li><span>Запустить сервисы Сибрус командой net start</span></li></ol><p><br/></p><p>При апгрейде с версии на версию, в которой появляются новые коллекции, надо два раза запускать -database-adm: один раз с командой database-upgrade, второй раз с командой indexes-create</p><p>автоматом новая коллекция не создается. а при создании коллекции не создаются индексы.<br/><br/></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="8716686">
<doc_id>
<![CDATA[8716686]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Установка OpenSSL]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Установка OpenSSL</h2><p class="header2">Для работы с сертификатами необходимо установить пакет OpenSSL.</p><p>Скачайте  со страницы <a href="http://slproweb.com/products/Win32OpenSSL.html">http://slproweb.com/products/Win32OpenSSL.html</a> и установите OpenSSL . Например, Win64 OpenSSL v1.0.2h Light</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2017-11-16_0-27-40.png"/></span></p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-54-25.png"/></span></p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-54-45.png"/></span></p><p><br/></p><p>Установите OpenSSL в папку по умолчанию C:\OpenSSL-Win64\bin\</p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-55-2.png"/></span></p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-55-17.png"/></span></p><p><br/></p><p>Выберите  OpenSSL DLLs to binaries (/bin) directory </p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-55-42.png"/></span></p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-5-25_11-55-53.png"/></span></p><p><br/></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="14614612">
<doc_id>
<![CDATA[14614612]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Новое руководство Сибрус для Windows домашняя страница1111111]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Новое руководство Сибрус для Windows домашняя страница1111111</h2><ac:layout><ac:layout-section ac:type="single"><ac:layout-cell><p class="auto-cursor-target"><br/></p><div class="alert alert-tip"><div class="codeHeader panelHeader pdl">Welcome to your new space!</div><div class="rich-text"><p>Confluence spaces are great for sharing content and news with your team. This is your home page. Right now it shows recent space activity, but you can customize this page in anyway you like.</p></div></div><h2>Complete these tasks to get started</h2><ac:task-list>
<ac:task>
<ac:task-id>57</ac:task-id>
<ac:task-status>incomplete</ac:task-status>
<ac:task-body><strong>Edit this home page</strong> - Click <em>Edit</em> in the top right of this screen to customize your Space home page</ac:task-body>
</ac:task>
<ac:task>
<ac:task-id>58</ac:task-id>
<ac:task-status>incomplete</ac:task-status>
<ac:task-body><strong>Create your first page</strong> - Click the <em>Create</em> button in the header to get started</ac:task-body>
</ac:task>
<ac:task>
<ac:task-id>59</ac:task-id>
<ac:task-status>incomplete</ac:task-status>
<ac:task-body><strong>Brand your Space</strong> - Click <em>Configure Sidebar</em> in the left panel to update space details and logo</ac:task-body>
</ac:task>
<ac:task>
<ac:task-id>60</ac:task-id>
<ac:task-status>incomplete</ac:task-status>
<ac:task-body><strong>Set permissions</strong> - Click <em>Space Tools</em> in the left sidebar to update permissions and give others access</ac:task-body>
</ac:task>
</ac:task-list><p> </p></ac:layout-cell></ac:layout-section><ac:layout-section ac:type="two_equal"><ac:layout-cell><h2>Recent space activity</h2><p><div class="alert alert-recently-updated"><ac:parameter ac:name="types">page, comment, blogpost</ac:parameter><ac:parameter ac:name="max">5</ac:parameter><ac:parameter ac:name="hideHeading">true</ac:parameter></div></p></ac:layout-cell><ac:layout-cell><h2>Space contributors</h2><p><div class="alert alert-contributors"><ac:parameter ac:name="mode">list</ac:parameter><ac:parameter ac:name="scope">descendants</ac:parameter><ac:parameter ac:name="limit">5</ac:parameter><ac:parameter ac:name="showLastTime">true</ac:parameter><ac:parameter ac:name="order">update</ac:parameter></div></p></ac:layout-cell></ac:layout-section><ac:layout-section ac:type="single"><ac:layout-cell><p> </p></ac:layout-cell></ac:layout-section></ac:layout></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="8716699">
<doc_id>
<![CDATA[8716699]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Инициализация БД и лицензирование Сервера]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Инициализация БД и лицензирование Сервера</h2><h4>1.Проинициализируйте базу данных</h4><p>Прочтите и подтвердите лицензионное соглашение. Для создания учетных записей администратора сервера и сервиса Медиаретранслятора введите и подтвердите пароли этих учетных записей.</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrusadm.exe --operation init --login admin --relayserver-login relay_server --domain cybrus.example --dbname cybrus_server</div></div></div><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-6-13_10-36-2.png"/></span></p><div class="alert alert-warning"><div class="rich-text"><p>ВАЖНО!</p><p>При инициализации базы создаётся уникальный идентификатор, к которому привязывается лицензия. Поэтому повторная инициализация допускается только до генерации запроса на лицензию.<br/>Повторная инициализация базы после генерации запроса на лицензию приведет к тому, что ваша лицензия станет недействительной. Восстановить её будет невозможно и вам придется приобретать ее заново.</p></div></div><p><br/></p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th colspan="2">Обязательные параметры:</th></tr><tr><td>--operation init</td><td>операция инициализации базы (выполняется только один раз!)</td></tr><tr><td>--domain</td><td>ваш домен СИБРУС ( полный логин содержит имя пользователя и домен СИБРУС. имя_пользователя@домен_Сибрус Домен используется для автоматической конфигурации клиента при первом подключении. желательно, чтоб имени домена соответствовала DNS-запись</td></tr><tr><td>--dbname</td><td>имя базы данных монго, где будет храниться вся информация сервера</td></tr><tr><td>--login</td><td>логин пользователя-администратора сервера</td></tr><tr><td>--relayserver-login</td><td>служебный логин, использующийся для подключения сервиса-медиаретранслятора</td></tr></tbody></table></div><h4>2.Сгенерируйте запрос на лицензию:</h4><p class="alarm">C:\cybrus\server\bin\cybrusadm --operation license_request --domain cybrus.example --dbname cybrus_server --license-request-file c:\cybrus\license_request.req   </p><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2017-11-16_0-10-3.png"/></span></p><p class="warning"><br/></p><div class="alert alert-warning"><div class="rich-text"><p class="warning">Важно! Лицензия будет привязана к проинициализированной базе.</p></div></div><p class="auto-cursor-target"><br/></p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th colspan="2">Обязательные параметры</th></tr><tr><td>--operation license_request</td><td>операция получения запроса лицензии</td></tr><tr><td>--domain</td><td>ваш домен Сибрус, указанный при инициализации базы в п.1</td></tr><tr><td>--dbname</td><td><span>имя базы данных, указанное при инициализации базы в п.1</span></td></tr><tr><td>--license-request-file</td><td><span>имя и путь к файлу, куда будет записан запрос на лицензию. Обратите внимание, что имя и путь к файлу не должны содержать символов национальных алфавитов и полностью состоять из латинских букв и/или цифр.</span></td></tr></tbody></table></div><h4>3.Отправьте файл запроса лицензии </h4><p>по электронной почте по адресу <a href="mailto:contact@cybrus.ru">contact@cybrus.ru</a> . Как только файл запроса лицензии будет получен, мы пришлем вам обратно файл лицензии.</p><p>В дальнейшем при добавлении дополнительных лицензий файл запроса не потребуется. Просто отправьте письмо с указанием количества дополнительных лицензий и после оплаты вы получите файл с дополнительными лицензиями.</p><h4>4.Проверьте полученный обратно файл лицензии</h4><p>Просмотрите его содержимое:</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrusadm --operation verify_license --domain cybrus.example --dbname cybrus_server --license-file &lt;файл лицензии&gt;</div></div></div><p class="auto-cursor-target"><br/></p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th colspan="2">Обязательные параметры</th></tr><tr><td>--operation verify_license</td><td>операция проверки лицензии</td></tr><tr><td>--domain</td><td><span>ваш домен Сибрус, указанный при инициализации базы в п.1</span></td></tr><tr><td>--dbname</td><td><span>имя базы данных, указанное при инициализации базы в п.1</span></td></tr><tr><td>--license-file</td><td><span>имя и путь к файлу лицензии. Обратите внимание, что имя и путь к файлу не должны содержать символов национальных алфавитов и полностью состоять из латинских букв и/или цифр.</span></td></tr></tbody></table></div><p><br/></p><h4 class="header2">5.Активируйте лицензию</h4><p>Для этого выполните команду:</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrusadm --operation activate_license --domain cybrus.example --dbname cybrus_server --license-file &lt;файл лицензии&gt;</div></div></div><p><br/></p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th colspan="2">Обязательные параметры</th></tr><tr><td>--operation activate_license</td><td>операция активации лицензии</td></tr><tr><td>--domain</td><td>ваш домен Сибрус, указанный при инициализации базы в п.1</td></tr><tr><td>--dbname</td><td>имя базы данных, указанное при инициализации базы в п.1</td></tr><tr><td>--license-file</td><td>имя и путь к файлу лицензии. Обратите внимание, что имя и путь к файлу не должны содержать символов национальных алфавитов и полностью состоять из латинских букв и/или цифр.</td></tr></tbody></table></div><p>После активации лицензии необходимо перезапустить сервер Сибрус или отправить ему команду обновить лицензии</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrusctl -o reload_license -d cybrus.example</div></div></div><p><br/></p><h4 class="header2">ПРИМЕЧАНИЯ</h4><h4 class="header2">Просмотреть текущий статус всех лицензионных пакетов</h4><p class="header2">можно в любой момент командой</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\server\bin\cybrusadm  --operation print_server_license --domain cybrus.example --dbname cybrus_server</div></div></div><p><br/></p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th colspan="2">Обязательные параметры</th></tr><tr><td>--operation print_server_license</td><td>операция печати лицензий</td></tr><tr><td>--domain</td><td>ваш домен Сибрус, указанный при инициализации базы в п.1</td></tr><tr><td>--dbname</td><td>имя базы данных, указанное при инициализации базы в п.1</td></tr></tbody></table></div><p>Если лицензия одна, то будет выведено ее содержимое. Если лицензионных пакетов несколько, то будет выведено содержимое всех лицензионных пакетов, а также совокупная лицензия, сформированная объединением всех актуальных для текущей даты и версии сервера лицензионных пакетов. А так же ближайший срок окончания лицензии</p><h4>Повторная инициализация базы</h4><div class="alert alert-warning"><div class="rich-text"><p>ВАЖНО!</p><p>При инициализации базы создаётся уникальный идентификатор, к которому привязывается лицензия. Поэтому повторная инициализация допускается только до генерации запроса на лицензию!</p><p>При инициализации базы лицензия становится недействительной!</p></div></div><p>Если вы решили проинициализировать базу заново, необходимо запустить программу mongo, указав в качестве параметра имя базы данных, которое вы указали при инициализации.</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\cybrus\mongo\bin\mongo.exe &lt;имя_базы&gt;</div></div></div><p>в ответ на приглашение программы mongo, необходимо выполнить команды</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">db.dropDatabase();</div><div class="line">exit</div></div></div><p class="auto-cursor-target"><br/></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="8716697">
<doc_id>
<![CDATA[8716697]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Установка и настройка сервисов СИБРУС]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Установка и настройка сервисов СИБРУС</h2><h4 class="console">Создайте папку для сервера Сибрус</h4><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">md c:\cybrus\server</div></div></div><h4 class="console">Распакуйте архив с сервером Сибрус в папку c:\cybrus\server\</h4><p>Обратите внимание, что в архиве находятся три папки \bin , \config и \locale</p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="8716703">
<doc_id>
<![CDATA[8716703]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Генерация ключей и получение сертификата сервера Сибрус]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Генерация ключей и получение сертификата сервера Сибрус</h2><p>При работе сервера канал связи между сервером и клиентскими приложениями шифруется. Вы можете использовать</p><p>1. Самоподписанный сертификат</p><p>2. Сертификат, подписанный разработчиками сервера Сибрус. Этот сертификат встроен в клиентское приложение.</p><p>3. Сертификат, подписанный вашим доверенным центром сертификации. В этом случае сертификат центра сертификации должен находится в хранилище сертификатов на клиентской машине. Вы так же можете использовать SSL сертификаты сторонних центров сертификации, такие например, как Symantec,  Thawte, GlobalSign, Geotrust или Comodo</p><div class="alert alert-note"><div class="rich-text">Использование самоподписанного сертификата рекомендуется на тестовый период. В дальнейшем следует установить сертификат доверенного УЦ.</div></div><h3 class="header2">Генерация самоподписанного сертификата</h3><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\OpenSSL-Win64\bin\openssl req -x509 -newkey rsa:3072 -days 3650 -keyout c:\cybrus\server\config\cybrus.key -out c:\cybrus\server\config\cybrus_certificate.pem ^</div><div class="line">-subj "/C=RU/ST=Moscow/L=Moscow/O=You Company Name/OU=IT/CN=cybrus.example/emailAddress=support@cybrus.example" ^</div><div class="line">-config C:\OpenSSL-Win64\bin\openssl.cfg</div></div></div><p class="console"><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-3-21_11-48-5.png"/></span></p><p class="console">На запрос "Enter PEM pass phrase:" необходимо придумать и ввести пароль для шифрования ключа cybrus.key</p><p>а на запрос "Verifying - Enter PEM pass phrase:" повторить его ввод </p><p class="console">Полученные ключ cybrus.key и сертификат cybrus_certificate.pem в дальнейшем используйте для конфигурирования сервера Сибрус и сервера автоконфигурации</p><h3>Генерация запроса сертификата</h3><h4>1. Сгенерируйте ключ и запрос сертификата для Сервера</h4><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">c:\OpenSSL-Win64\bin\openssl req -newkey rsa:3072 -keyout c:\cybrus\server\config\cybrus.key -out c:\cybrus\server\config\cybrus_request.csr ^</div><div class="line">-subj "/C=RU/ST=Moscow/L=Moscow/O=You Company Name/OU=IT/CN=cybrus.example/emailAddress=support@cybrus.example" ^</div><div class="line">-config C:\OpenSSL-Win64\bin\openssl.cfg</div></div></div><p><span class="image-wrapper"><img class="img-responsive" src="/support/en/standalone/windows/attachments/image2018-3-21_11-49-15.png"/></span></p><p class="console">На запрос "Enter PEM pass phrase:" необходимо придумать и ввести пароль для шифрования ключа cybrus.key</p><p>а на запрос "Verifying - Enter PEM pass phrase:" повторить его ввод </p><div class="alert alert-note"><div class="rich-text"><p>При генерации сертификата и запроса сертификата обязательно заполните поля (латинскими буквами) в параметре -subj</p><div class="table-responsive"><table class="table"><colgroup><col/><col/></colgroup><tbody><tr><th><br/></th><th><br/></th></tr><tr><td>C</td><td>страна</td></tr><tr><td>ST</td><td>область</td></tr><tr><td>L</td><td>город</td></tr><tr><td>O</td><td>название организации</td></tr><tr><td>OU</td><td>отдел в организации</td></tr><tr><td>CN</td><td>название вашего домена Сибрус</td></tr><tr><td colspan="1">emailAddress</td><td colspan="1">контактная эл.почта</td></tr></tbody></table></div><p class="auto-cursor-target"><br/></p></div></div><h4>2. Подпишите запрос сертификата у своего доверенного центра сертификации</h4><p>Файл запроса сертификата cybrus_request.csr необходимо направить нам по электронной почте по адресу <a href="mailto:contact@cybrus.ru">contact@cybrus.ru</a>. Обратно мы пришлем вам сертификат.  Или подпишите запрос у своего доверенного центра сертификации.</p><p>Полученные в п.1 ключ cybrus.key и сертификат полученный в п.2 в дальнейшем используйте для конфигурирования сервера Сибрус  и сервера автоконфигурации</p><p><br/></p><div><code class="powershell string"><span><br/></span></code></div></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
<sphinx:document id="8716705">
<doc_id>
<![CDATA[8716705]]>
</doc_id>
<lang>en</lang>
<os>windows</os>
<edition>standalone</edition>
<title>
<![CDATA[Конфигурирование ОС]]>
</title>
<content>
<![CDATA[<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<div xmlns:ac="http://www.vipole.com/support" xmlns:ri="http://www.vipole.com/support/attacments" class="support article"><h2>Конфигурирование ОС</h2><p>Во время инсталляции Сервера потребуется установка дополнительных компонентов:</p><ul class="square"><li><span>MongoDB , версия 3.4 (рекомендуется)</span></li><li><span>Redis, версия 2.8</span></li><li><span>Win64 OpenSSL v1.0.x </span></li></ul><h3>Требования к системе</h3><ul class="square"><li><span>64бит версии Windows Server 2008 R2 , Windows Server 2012 r2 или Windows Server 2016</span></li><li><span>Многоядерный процессор (рекомендуется 4 ядра)</span></li><li><span>8+ Gb RAM</span></li><li><span>200Gb HDD (RAID1 or RAID10)</span></li></ul><h3>Настройки брандмауэра Windows</h3><p>Проверьте настройки брандмауэра Windows. Настройте его так, чтобы не блокировались порты, используемые службами Сибрус. Номера портов можно посмотреть в файлах конфигурации Сервера.</p><div class="code panel pdl"><div class="codeHeader panelHeader pdl">server.config</div><div class="codeContent panelContent pdl"><div class="comment line"># Server port</div><div class="line">listen-port = 37210</div><div class="comment line"># UDP port of SIP server</div><div class="line">sip-server-port=5060</div></div></div><p><br/></p><div class="code panel pdl"><div class="codeHeader panelHeader pdl">server-auto.config</div><div class="codeContent panelContent pdl"><div class="comment line"># Server port</div><div class="line">listen-port = 37212</div></div></div><p>В файле конфигурации Медиаретранслятора relay.config указывается диапазон портов !</p><div class="code panel pdl"><div class="codeHeader panelHeader pdl">relay.config</div><div class="codeContent panelContent pdl"><div class="comment line"># UDP ports range</div><div class="comment line"># Minimum UDP port</div><div class="line">min-port=3000</div><div class="comment line"># Maximum UDP port </div><div class="line">max-port=9000</div></div></div><p>При настройке брандмауэра Windows обратите внимание на порты, используемые службами Redis и Mongo. Они должны быть закрыты для доступа из сети Интернет.</p><p>Пример команд для настройки брандмауэра Windows:</p><div class="code panel pdl"><div class="codeContent panelContent pdl"><div class="line">netsh advfirewall firewall add rule name="VIPole server" protocol=TCP localport=37210 action=allow dir=IN</div><div class="line">netsh advfirewall firewall add rule name="VIPole config" protocol=TCP localport=37212 action=allow dir=IN</div><div class="line">netsh advfirewall firewall add rule name="VIPole relay" protocol=UDP localport=3000-9000 action=allow dir=IN</div></div></div><p class="auto-cursor-target"><br/></p></div>
]]>
</content>
<langint>0</langint>
<editionint>0</editionint>
<osint>1</osint>
</sphinx:document>
</sphinx:docset>